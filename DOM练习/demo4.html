<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>第七章动态创建标记</title>
	<style type="text/css">
		img{
			display: block;
			width:800px;
			height:500px;
			border:1px solid #000;
		}
		#imagegallery{
			list-style: none;
		}
		#imagegallery li{
			display: inline;
		}
	</style>
</head>
<body>
   <ul id="imagegallery">
    	<li><a href="images/1.jpg" title="动漫1">动漫图片一</a></li>
    	<li><a href="images/2.jpg" title="动漫2">动漫图片二</a></li>
    	<li><a href="images/3.jpg" title="动漫3">动漫图片三</a></li>
    	<li><a href="images/4.jpg" title="动漫4">动漫图片四</a></li>
    </ul>
    <!-- <img id="placeholder" src="images/5.jpg" alt="展示区" />
    <p id="description">图片描述</p> -->
<script type="text/javascript">
	function addLoadEvent(func){
       var oldonload=window.onload;
       if(typeof window.onload!='function'){
          window.onload=func;
       }else{
          window.onload=function(){
          	oldonload();
          	func();	
          }
       }
	}
  addLoadEvent(prepareGallery);
  addLoadEvent(preparePlaceholder);
 
	function prepareGallery(){
 	  if(!document.getElementById){
         return false;
 	  }
 	  if(!document.getElementsByTagName){
         return false;
 	  }
 	  if(!document.getElementById("imagegallery")){
         return false;
 	  }
 	  var gallery=document.getElementById("imagegallery");
 	  var links=gallery.getElementsByTagName("a");
 	  for(var i=0;i<links.length;i++){
           links[i].onclick=function(){
                return showPic(this)?false:true;
           };
 	  }
	}

	function showPic(whichpic){
    	if(!document.getElementById("placeholder")){
            return false;
    	}
        var source=whichpic.getAttribute("href");
        var placeholder=document.getElementById("placeholder");
        if(placeholder.nodeName!="IMG"){
            return false;	
        }
        placeholder.setAttribute("src",source);
        if(document.getElementById("description")){
        	if(whichpic.getAttribute("title")){
                var text=whichpic.getAttribute("title");
        	}else{
                var text=" ";
        	}
	        var description=document.getElementById("description");
	        if(description.firstChild.nodeValue=3){
	           description.firstChild.nodeValue=text;
	        }
	    }
	    return true;
    }
    function preparePlaceholder(){
      if(!document.createElement){
          return false;
      }
      if(!document.createTextNode){
          return false;
      }
      if(!document.getElementById){
          return false;
      }
      if(!document.getElementById("imagegallery")){
          return false;
      }
      var placeholder=document.createElement("img");
      placeholder.setAttribute("id","placeholder");
      placeholder.setAttribute("src","images/5.jpg");
      placeholder.setAttribute("alt","展示区");
      var description=document.createElement("p");
      description.setAttribute("id","description");
      var desctext=document.createTextNode("图片描述");
      description.appendChild(desctext);
      var gallery=document.getElementById("imagegallery");
      insertAfter(placeholder,gallery);
      insertAfter(description,placeholder);
    }
    function insertAfter(newElement,targetElement){
      var parent=targetElement.parentNode;
      if(parent.lastChild==targetElement){
        parent.appendChild(newElement);
      }else{
        parent.insertBefore(newElement,targetElement.nextSibling);
      }
    }
</script>
</body>
</html>